<style>
    .towp{margin-left:10px;}
    .classfy1{ margin-top: 0;}
    .web_code{
        border:0px solid red;
    }
    .cla-swi, .cla-pro, .xlph, .yd_parent{
        position: relative;              

    }
    .sideNaiv .yd_parent1{
        width: 214px; 
        height: 226px;   
        position: relative; 
    }
    .sideNaiv .yd_parent2{      

        position: relative; 
    }
    .yd_edit{      
        padding: 4px 6px;
        background-color: #4bbd00;
        position: absolute;
        right: 0;
        z-index: 600;
        cursor: pointer
    }
    .tab-wrap{padding-left: 20px;}
    .cate-sortable{height: 160px; border: 2px solid #ccc;  overflow-y: scroll;}
    .cate-sortable dd{cursor: pointer; float: left;line-height: 20px; padding: 6px 20px;margin: 2px; border:1px solid #ccc; clear: right;position: relative;}
    .cate-sortable dd:hover{
        border-color: #F30;
        box-shadow: 2px 2px 0 rgba(204,204,204,0.5);
    }
    .cate-sortable dd:hover i{
        display: block;
    }
    .cate-sortable dd i{           
        background-color: #FFF;
        display: inline-block;
        margin: 0 0 6px 2px;
        padding:5px;
        border: solid 2px #FFF;
        position: relative;
        z-index: 1;
        cursor: pointer;
        border:1px solid #E06040;
        position: absolute;
        top:0;
        right:0;
        background:#E06040 url('__JS__/web_code/colse.png') no-repeat;
        display: none;
    }
    
    .goods-sortable1 dd,.goods-sortable2 dd{overflow: hidden; height: 14px; line-height: 18px;}
    .goods-sortable1, .goods-sortable2{height: 240px; float: left;width: 48%; margin-left: 5px; border: 2px solid #ccc;  overflow-y: scroll;}
    .goods-sortable1 dd, .goods-sortable2 dd{cursor: pointer;line-height: 18px; padding: 6px 10px;margin: 2px; border:1px solid #ccc; clear: right;position: relative;}
    .goods-sortable2 dd:hover{
        border-color: #F30;
        box-shadow: 2px 2px 0 rgba(204,204,204,0.5);
    }
    .goods-sortable2 dd:hover i{
        display: block;
    }
    .goods-sortable2 dd i{           
        background-color: #FFF;
        display: inline-block;
        margin: 0 0 6px 2px;
        padding:5px;
        border: solid 2px #FFF;
        position: relative;
        z-index: 1;
        cursor: pointer;
        border:1px solid #E06040;
        position: absolute;
        top:0;
        right:0;
        background:#E06040 url('__JS__/web_code/colse.png') no-repeat;
        display: none;
    }
    .goods-sortable3 dd,.goods-sortable4 dd{overflow: hidden; height: 14px; line-height: 18px;}
    .goods-sortable3, .goods-sortable4{height: 240px; float: left;width: 48%; margin-left: 5px; border: 2px solid #ccc;  overflow-y: scroll;}
    .goods-sortable3 dd, .goods-sortable4 dd{cursor: pointer;line-height: 18px; padding: 6px 10px;margin: 2px; border:1px solid #ccc; clear: right;position: relative;}
    .goods-sortable4 dd:hover{
        border-color: #F30;
        box-shadow: 2px 2px 0 rgba(204,204,204,0.5);
    }
    .goods-sortable4 dd:hover i{
        display: block;
    }
    .goods-sortable4 dd i{           
        background-color: #FFF;
        display: inline-block;
        margin: 0 0 6px 2px;
        padding:5px;
        border: solid 2px #FFF;
        position: relative;
        z-index: 1;
        cursor: pointer;
        border:1px solid #E06040;
        position: absolute;
        top:0;
        right:0;
        background:#E06040 url('__JS__/web_code/colse.png') no-repeat;
        display: none;
    }
</style>  
<!--标题管理 S-->
<div id="web-code-title" style='display:none;'>
    <div class="tab-wrap">
        <form action="{:U('websetting/code_update')}" id="form-title" method="post" class="form-horizontal">
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">楼层编号： </label>
                    <input type="text" name="tit[floor]" class="text input-2x"  value="{$code_info.tit.code_info.floor|default='F1'}">
                </div>
            </div>
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">英文名称： </label>
                    <input type="text" name="tit[en_name]" class="text input-4x"  value="{$code_info.tit.code_info.en_name|default=''}">
                </div>
            </div>
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">模块标题： </label>
                    <input type="text" name="tit[name]" class="text input-4x"  value="{$code_info.tit.code_info.name|default=''}">
                </div>
            </div>

            <div class="form-item" id="type1">
                <label class="item-label">模块LOGO<span class="check-tips">（请上传模块的lOGO 32px * 32px）</span></label>
                <div class="controls">
                    <input type="file" id="upload_picture_tit_icon">
                    <input type="hidden" name="tit[icon]" id="cover_id_tit_icon" value="{$code_info.tit.code_info.icon}"/>
                    <div class="upload-img-box">
                        <notempty name="code_info['tit']['code_info']['icon']"><div class="upload-pre-item"><img src="__PICURL__/1/{$code_info.tit.code_info.icon|get_cover='path'}{$info.path}"/></div></notempty>
                    </div>
                </div>
                <script type="text/javascript">
                    //上传图片
                    /* 初始化上传插件 */
                    $("#upload_picture_tit_icon").uploadify({
                    "height"          : 30,
                            "swf"             : "__STATIC__/uploadify/uploadify.swf",
                            "fileObjName"     : "download",
                            "buttonText"      : "上传图片",
                            "uploader"        : "{:U('File/uploadPicture',array('session_id'=>session_id()))}",
                            "width"           : 120,
                            'removeTimeout'	  : 1,
                            'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
                            "onUploadSuccess" : uploadPicture{$field.name},
                            'onFallback' : function() {
                            alert('未检测到兼容版本的Flash.');
                            },
                            'onUploadStart':function(file){
                            var domainid = 1;
                                    $('#upload_picture_tit_icon').uploadify('settings', "formData", { 'domainid': domainid });
                            }
                    });
                            function uploadPicture{$field.name}(file, data){
                    var data = $.parseJSON(data);
                            var src = '';
                            if (data.status){
                    $("#cover_id_tit_icon").val(data.id);
                            var domainid = 1;
                            src = data.url || '__PICURL__' + domainid + '/' + data.path
                            $("#cover_id_tit_icon").parent().find('.upload-img-box').html(
                            '<div class="upload-pre-item"><img src="' + src + '"/></div>'
                            );
                    } else {
                    updateAlert(data.info);
                            setTimeout(function(){
                            $('#top-alert').find('button').click();
                                    $(that).removeClass('disabled').prop('disabled', false);
                            }, 1500);
                    }
                    }
                </script>
            </div>
            <div class="form-item">
                <input type="hidden" name="id" value="{$info.id|default=''}">
                <input type="hidden" name="code_id" value="{$code_info.tit.code_id}">
                <input type="hidden" name="var_name" value="{$code_info.tit.var_name|default='tit'}">
                <button class="btn submit-btn ajax-post" onclick="submit_form('form-title')" type="button" target-form="form-horizontal">确 定</button>
                <button class="btn btn-return" onclick="javascript:history.back( - 1); return false;">返 回</button>
            </div>    
        </form>
    </div>
</div>
<!--标题管理 E-->

<!--左边广告管理 S-->
<div id="web-code-left-ads" style='display:none;'>
    <div class="tab-wrap">
        <form action="{:U('websetting/code_update')}" method="post" id="form-left-ads" class="form-horizontal">
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">广告名称</label>
                    <input type="text" name="left_ad[ad_name]" class="text input-4x"  value="{$code_info.left_ad.code_info.ad_name|default=''}">
                </div>
            </div>
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">广告链接<span class="check-tips">（如果为空则为分类链接）</span></label>
                    <input type="text" placeholder="http://" name="left_ad[ad_url]" class="text input-4x"  value="{$code_info.left_ad.code_info.ad_url|default=''}">
                </div>
            </div>
            <div class="form-item" id="type1">
                <label class="item-label">广告图片<span class="check-tips">（广告图片 220px * 220px）</span></label>
                <div class="controls">
                    <input type="file" id="upload_picture_lad_icon">
                    <input type="hidden" name="left_ad[icon]" id="cover_id_lad_icon" value="$code_info.left_ad.code_info.icon"/>
                    <div class="upload-img-box">
                        <notempty name="code_info['left_ad']['code_info']['icon']"><div class="upload-pre-item"><img src="__PICURL__/1/{$code_info.left_ad.code_info.icon|get_cover='path'}"/></div></notempty>
                    </div>
                </div>
                <script type="text/javascript">
                            //上传图片
                            /* 初始化上传插件 */
                            $("#upload_picture_lad_icon").uploadify({
                    "height"          : 30,
                            "swf"             : "__STATIC__/uploadify/uploadify.swf",
                            "fileObjName"     : "download",
                            "buttonText"      : "上传图片",
                            "uploader"        : "{:U('File/uploadPicture',array('session_id'=>session_id()))}",
                            "width"           : 120,
                            'removeTimeout'	  : 1,
                            'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
                            "onUploadSuccess" : uploadPicture{$field.name},
                            'onFallback' : function() {
                            alert('未检测到兼容版本的Flash.');
                            },
                            'onUploadStart':function(file){
                            var domainid = 1;
                                    $('#upload_picture_lad_icon').uploadify('settings', "formData", { 'domainid': domainid });
                            }
                    });
                            function uploadPicture{$field.name}(file, data){
                    var data = $.parseJSON(data);
                            var src = '';
                            if (data.status){
                    $("#cover_id_lad_icon").val(data.id);
                            var domainid = 1;
                            src = data.url || '__PICURL__' + domainid + '/' + data.path
                            $("#cover_id_lad_icon").parent().find('.upload-img-box').html(
                            '<div class="upload-pre-item"><img src="' + src + '"/></div>'
                            );
                    } else {
                    updateAlert(data.info);
                            setTimeout(function(){
                            $('#top-alert').find('button').click();
                                    $(that).removeClass('disabled').prop('disabled', false);
                            }, 1500);
                    }
                    }
                </script>
            </div>
            <div class="form-item">
                <input type="hidden" name="id" value="{$info.id|default=''}">
                <input type="hidden" name="code_id" value="{$code_info.left_ad.code_id|default=''}">
                <input type="hidden" name="var_name" value="{$code_info.left_ad.var_name|default='left_ad'}">
                <button class="btn submit-btn ajax-post" id="submit"  onclick="submit_form('form-left-ads')" type="button" target-form="form-horizontal">确 定</button>
            </div>    
        </form>
    </div>
</div>
<!--左边广告管理 E-->
<!--左边推荐分类管理 S-->
<div id="web-code-left-category" style='display:none;'>
    <div class="tab-wrap">
        <form action="{:U('websetting/code_update')}" method="post" id="form-left-category" class="form-horizontal">
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">筛选分类</label>
                    <select name="category_list" class=" select ">
                        <option value="0">请选择模块分类</option>
                        <volist name="category_list" id="cate">
                            <option  value="{$cate.id}">{$cate.title}</option>
                        </volist>
                    </select>
                </div>
            </div>
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">分类列表<span class="check-tips">小提示：双击分类名称可删除不想显示的分类</span></label>
                    <dl class="cate-sortable">
                        <empty name="code_info.cate_list.code_info.goods_class">
                            <volist name="category_list" id="cate">
                                <dd gc_id="{$cate.id}" title="{$cate.title}" ondblclick="del_goods_class('{$cate.id}');">
                                    <i onclick="del_goods_class('{$cate.id}');"></i>{$cate.title}          
                                    <input name="cate_list[goods_class][{$cate.id}][id]" value="{$cate.id}" type="hidden">
                                    <input name="cate_list[goods_class][{$cate.id}][gc_name]" value="{$cate.title}" type="hidden">
                                </dd>
                                <volist name="cate['_child']" id="childcate">
                                    <dd gc_id="{$childcate.id}" title="{$childcate.title}" ondblclick="del_goods_class('{$childcate.id}');">
                                        <i onclick="del_goods_class('{$childcate.id}');"></i>{$childcate.title}          
                                        <input name="cate_list[goods_class][{$childcate.id}][id]" value="{$childcate.id}" type="hidden">
                                        <input name="cate_list[goods_class][{$childcate.id}][gc_name]" value="{$childcate.title}" type="hidden">
                                    </dd>
                                </volist>
                            </volist>
                            <else /> 
                            <volist name="code_info.cate_list.code_info.goods_class" id="class" offset="0" length='6'>
                                <dd gc_id="{$class.id}" title="{$class.gc_name}" ondblclick="del_goods_class('{$class.id}');">
                                    <i onclick="del_goods_class('{$class.id}');"></i>{$class.gc_name}          
                                    <input name="cate_list[goods_class][{$class.id}][id]" value="{$class.id}" type="hidden">
                                    <input name="cate_list[goods_class][{$class.id}][gc_name]" value="{$class.gc_name}" type="hidden">
                                </dd>
                            </volist>
                        </empty> 
                    </dl>
                </div>
            </div>
            <div class="form-item">
                <input type="hidden" name="id" value="{$info.id|default=''}">
                <input type="hidden" name="code_id" value="{$code_info.cate_list.code_id|default=''}">
                <input type="hidden" name="var_name" value="{$code_info.cate_list.var_name|default='cate_list'}">
                <button class="btn submit-btn ajax-post" id="submit"  onclick="submit_form('form-left-category')" type="button" target-form="form-horizontal">确 定</button>
            </div>    
        </form>
    </div>
</div>
<!--左边推荐分类管理 E-->
<!--中间广告管理 S-->
<div id="web-code-mid-ads" style='display:none;'>
    <div class="tab-wrap">
        <form action="{:U('websetting/code_update')}" method="post" id="form-mid-ads" class="form-horizontal">
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">广告名称</label>
                    <input type="text" name="mid_ad[ad_name]" class="text input-4x"  value="{$code_info.mid_ad.code_info.ad_name|default=''}">
                </div>
            </div>
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">广告链接<span class="check-tips">（如果为空则为分类链接）</span></label>
                    <input type="text" placeholder="http://" name="mid_ad[ad_url]" class="text input-4x"  value="{$code_info.mid_ad.code_info.ad_url|default=''}">
                </div>
            </div>
            <div class="form-item" id="type1">
                <label class="item-label">广告图片<span class="check-tips">（广告图片 220px * 220px）</span></label>
                <div class="controls">
                    <input type="file" id="upload_picture_mid_icon">
                    <input type="hidden" name="mid_ad[icon]" id="cover_id_mid_icon" value="{$code_info.mid_ad.code_info.icon}"/>
                    <div class="upload-img-box">
                        <notempty name="code_info['mid_ad']['code_info']['icon']"><div class="upload-pre-item"><img src="__PICURL__/1/{$code_info.mid_ad.code_info.icon|get_cover='path'}"/></div></notempty>
                    </div>
                </div>
                <script type="text/javascript">
                            //上传图片
                            /* 初始化上传插件 */
                            $("#upload_picture_mid_icon").uploadify({
                    "height"          : 30,
                            "swf"             : "__STATIC__/uploadify/uploadify.swf",
                            "fileObjName"     : "download",
                            "buttonText"      : "上传图片",
                            "uploader"        : "{:U('File/uploadPicture',array('session_id'=>session_id()))}",
                            "width"           : 120,
                            'removeTimeout'	  : 1,
                            'fileTypeExts'	  : '*.jpg; *.png; *.gif;',
                            "onUploadSuccess" : uploadPicture{$field.name},
                            'onFallback' : function() {
                            alert('未检测到兼容版本的Flash.');
                            },
                            'onUploadStart':function(file){
                            var domainid = 1;
                                    $('#upload_picture_mid_icon').uploadify('settings', "formData", { 'domainid': domainid });
                            }
                    });
                            function uploadPicture{$field.name}(file, data){
                    var data = $.parseJSON(data);
                            var src = '';
                            if (data.status){
                    $("#cover_id_mid_icon").val(data.id);
                            var domainid = 1;
                            src = data.url || '__PICURL__' + domainid + '/' + data.path
                            $("#cover_id_mid_icon").parent().find('.upload-img-box').html(
                            '<div class="upload-pre-item"><img src="' + src + '"/></div>'
                            );
                    } else {
                    updateAlert(data.info);
                            setTimeout(function(){
                            $('#top-alert').find('button').click();
                                    $(that).removeClass('disabled').prop('disabled', false);
                            }, 1500);
                    }
                    }
                </script>
            </div>
            <div class="form-item">
                <input type="hidden" name="id" value="{$info.id|default=''}">
                <input type="hidden" name="code_id" value="{$code_info.mid_ad.code_id|default=''}">
                <input type="hidden" name="var_name" value="{$code_info.mid_ad.var_name|default='mid_ad'}">
                <button class="btn submit-btn ajax-post" id="submit"  onclick="submit_form('form-mid-ads')" type="button" target-form="form-horizontal">确 定</button>
            </div>    
        </form>
    </div>
</div>
<!--中间广告管理 E-->
<!--中间商品管理 S-->
<div id="web-code-mid-goods" style='display:none;'>
    <div class="tab-wrap">
        <form action="{:U('websetting/code_update')}" method="post" id="form-mid-goods" class="form-horizontal">
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">输入商品关键字</label>
                    <input type="text" name="mid_goods[kewords]" class="text input-4x" id="goodskeywords"  value="{$code_info.mid_goods.code_info.kewords|default=''}">
                    <button id="searchgoods"  class="btn" type="button">搜索</button>
                </div>
            </div>
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">查询商品列表<span class="check-tips">双击选中商品</span><label class="item-label" style="float:right;">添加商品列表</label></label>
                    <dl class="goods-sortable1">
                            <volist name="goods_lists" id="goods" >
                                <dd gc_id="{$goods.id}" title="{$goods.title}" ondblclick="move_goods_item('{$goods.id}');">
                                    <i onclick="del_goods_item('{$goods.id}');"></i>{$goods.title}          
                                    <input name="temp_mid_goods[goods_list][{$goods.id}][id]" value="{$goods.id}" type="hidden">
                                    <input name="temp_mid_goods[goods_list][{$goods.id}][title]" value="{$goods.title}" type="hidden">
                                    <input name="temp_mid_goods[goods_list][{$goods.id}][price]" value="{$goods.price}" type="hidden">
                                    <input name="temp_mid_goods[goods_list][{$goods.id}][cover_id]" value="{$goods.cover_id}" type="hidden">
                                    <input name="temp_mid_goods[goods_list][{$goods.id}][marketprice]" value="{$goods.marketprice}" type="hidden">
                                </dd>
                            </volist>
                    </dl>
                     
                    <dl class="goods-sortable2">
                        <volist name="code_info.mid_goods.code_info.goods_list" id="goods" >
                                <dd gc_id="{$goods.id}" title="{$goods.title}" ondblclick="del_goods_item('{$goods.id}');">
                                    <i onclick="del_goods_item('{$class.id}');"></i>{$goods.title}          
                                    <input name="mid_goods[goods_list][{$goods.id}][id]" value="{$goods.id}" type="hidden">
                                    <input name="mid_goods[goods_list][{$goods.id}][title]" value="{$goods.title}" type="hidden">
                                    <input name="mid_goods[goods_list][{$goods.id}][price]" value="{$goods.price}" type="hidden">
                                    <input name="mid_goods[goods_list][{$goods.id}][cover_id]" value="{$goods.cover_id}" type="hidden">
                                    <input name="mid_goods[goods_list][{$goods.id}][marketprice]" value="{$goods.marketprice}" type="hidden">
                                </dd>
                        </volist>
                    </dl>
                </div>
            </div>
            <div class="form-item">
                <input type="hidden" name="id" value="{$info.id|default=''}">
                <input type="hidden" name="code_id" value="{$code_info.mid_goods.code_id|default=''}">
                <input type="hidden" name="var_name" value="{$code_info.mid_goods.var_name|default='mid_goods'}">
                <button class="btn submit-btn ajax-post" id="submit"  onclick="submit_form('form-mid-goods')" type="button" target-form="form-horizontal">确 定</button>
            </div>    
        </form>
    </div>
</div>
<!--中间商品管理 E-->
<!--右边热卖商品管理 S-->
<div id="web-code-right-hotgoods" style='display:none;'>
    <div class="tab-wrap">
        <form action="{:U('websetting/code_update')}" method="post" id="form-hot-goods" class="form-horizontal">
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">输入商品关键字</label>
                    <input type="text" name="hot_goods[kewords]" class="text input-4x" id="goodskeywords2"  value="{$code_info.hot_goods.code_info.kewords|default=''}">
                    <button id="searchgoods2"  class="btn" type="button">搜索</button>
                </div>
            </div>
            <div class="form-item">
                <div class="controls">
                    <label class="item-label">查询商品列表<span class="check-tips">双击选中商品</span><label class="item-label" style="float:right;">添加商品列表</label></label>
                    <dl class="goods-sortable3">
                            <volist name="goods_lists" id="goods" >
                                <dd gc_id="{$goods.id}" title="{$goods.title}" ondblclick="move_goods_item2('{$goods.id}');">
                                    <i onclick="del_goods_item2('{$goods.id}');"></i>{$goods.title}          
                                    <input name="temp_hot_goods[goods_list][{$goods.id}][id]" value="{$goods.id}" type="hidden">
                                    <input name="temp_hot_goods[goods_list][{$goods.id}][title]" value="{$goods.title}" type="hidden">
                                    <input name="temp_hot_goods[goods_list][{$goods.id}][price]" value="{$goods.price}" type="hidden">
                                    <input name="temp_hot_goods[goods_list][{$goods.id}][cover_id]" value="{$goods.cover_id}" type="hidden">
                                    <input name="temp_hot_goods[goods_list][{$goods.id}][marketprice]" value="{$goods.marketprice}" type="hidden">
                                </dd>
                            </volist>
                    </dl>
                     
                    <dl class="goods-sortable4">
                        <volist name="code_info.hot_goods.code_info.goods_list" id="goods" >
                                <dd gc_id="{$goods.id}" title="{$goods.title}" ondblclick="del_goods_item2('{$goods.id}');">
                                    <i onclick="del_goods_item2('{$class.id}');"></i>{$goods.title}          
                                    <input name="hot_goods[goods_list][{$goods.id}][id]" value="{$goods.id}" type="hidden">
                                    <input name="hot_goods[goods_list][{$goods.id}][title]" value="{$goods.title}" type="hidden">
                                    <input name="hot_goods[goods_list][{$goods.id}][price]" value="{$goods.price}" type="hidden">
                                    <input name="hot_goods[goods_list][{$goods.id}][cover_id]" value="{$goods.cover_id}" type="hidden">
                                    <input name="hot_goods[goods_list][{$goods.id}][marketprice]" value="{$goods.marketprice}" type="hidden">
                                </dd>
                        </volist>
                    </dl>
                </div>
            </div>
            <div class="form-item">
                <input type="hidden" name="id" value="{$info.id|default=''}">
                <input type="hidden" name="code_id" value="{$code_info.hot_goods.code_id|default=''}">
                <input type="hidden" name="var_name" value="{$code_info.hot_goods.var_name|default='hot_goods'}">
                <button class="btn submit-btn ajax-post" id="submit"  onclick="submit_form('form-hot-goods')" type="button" target-form="form-horizontal">确 定</button>
            </div>    
        </form>
    </div>
</div>
<!--→右边热卖商品管理 E-->

<block name="script">
    <script type="text/javascript" src="__STATIC__/layer/layer.js"></script>
    <script type="text/javascript" charset="utf-8">
 var domainid = "{$info.id}";
    $("#submit-tit").click(function(){
        $.ajax({
            type: 'POST',
            url: $("#form-title").attr('action'),
            data:$("#form-title").serialize(),
            success: function(res){
                if (res.status){
                    layer.msg(res.info);
                } else{
                    layer.msg(res.info);
                }
            }
        });
    });
            // 提交表单
    function submit_form(form_id){
    $.ajax({
        type: 'POST',
        url: $("#" + form_id).attr('action'),
        data:$("#" + form_id).serialize(),
        success: function(res){
            if (res.status){
                    layer.msg(res.info);
                    setTimeout("window.location.reload(true)", 1000);
            } else{
                layer.msg(res.info);
            }
        }
    });
    }

    // 显示提示框
    function show_dialog(title, width, height, model_id, code_id){
    $("#" + model_id).find("input[name=code_id]").val(code_id);
        var layer_index = layer.open({
            title:"{$info.name}．" + title,
            type: 1,
            area: [width, height],
            shadeClose: true, //点击遮罩关闭
            content: $("#" + model_id)
        });
    }


    function del_goods_class(gc_id){
        var obj = $("dd[gc_id='" + gc_id + "']");
        obj.remove();
    }
    
    function del_goods_item(gc_id){
        var obj = $(".goods-sortable2").find("dd[gc_id='" + gc_id + "']");
        obj.remove();
    }
    
    function move_goods_item(goods_id){
        var obj = $(".goods-sortable1").find("dd[gc_id='" + goods_id + "']");
        obj.attr("ondblclick").replace("move_goods_item","del_goods_class");
        var _tmp =  obj.html().replace("temp_mid_goods", 'mid_goods').replace("temp_mid_goods", 'mid_goods').replace("temp_mid_goods", 'mid_goods').replace("temp_mid_goods", 'mid_goods').replace("temp_mid_goods", 'mid_goods');
        obj.html(_tmp);
        var t= $(".goods-sortable2").html();
        if(t.length > 45){
           var gc_id = $(".goods-sortable2").find("dd[gc_id='" + goods_id + "']").attr('gc_id');
            if(eval(gc_id) != goods_id){
                   obj.appendTo(".goods-sortable2");
               }else{
                   layer.msg('该商品已经添加'); 
                   $(".goods-sortable1").find("dd[gc_id='" + goods_id + "']").remove();
                    return false;
               }
//            $(".goods-sortable2 dd").each(function(index){
//                var gc_id = $(this).attr("gc_id");
//               if(eval(gc_id) != goods_id){
//                   obj.appendTo(".goods-sortable2");
//               }else{
//                   layer.msg('该商品已经添加'); 
//                   
//                    return false;
////                   $(".goods-sortable1").find("dd[gc_id='" + goods_id + "']").remove();
//               }
//            })
        }else{
           obj.appendTo(".goods-sortable2"); 
        }
    }
    /**
     * 删除热销商品
     */
    function del_goods_item2(gc_id){
        var obj = $(".goods-sortable4").find("dd[gc_id='" + gc_id + "']");
        obj.remove();
    }
    /**
     * 热销商品
     */
    function move_goods_item2(goods_id){
        var obj = $(".goods-sortable3").find("dd[gc_id='" + goods_id + "']");
        obj.attr("ondblclick").replace("move_goods_item2","del_goods_item2");
        var _tmp =  obj.html().replace("temp_hot_goods", 'hot_goods').replace("temp_hot_goods", 'hot_goods').replace("temp_hot_goods", 'hot_goods').replace("temp_hot_goods", 'hot_goods').replace("temp_hot_goods", 'hot_goods');
        obj.html(_tmp);
        var t= $(".goods-sortable4").html();
        if(t.length > 45){
             var gc_id = $(".goods-sortable4").find("dd[gc_id='" + goods_id + "']").attr('gc_id');
             if(eval(gc_id) != goods_id){
                   obj.appendTo(".goods-sortable4");
               }else{
                   layer.msg('该商品已经添加2');
                   $(".goods-sortable3").find("dd[gc_id='" + goods_id + "']").remove();
                   return false;
               }
        }else{
           obj.appendTo(".goods-sortable4"); 
        }
    }
    // 热卖商品
    $("#searchgoods2").click(function(){
        var keywords = $("#goodskeywords2").val();
        if(keywords.length<0){
            layer.msg('请输入关键词！');
            return false;
        }
        $.ajax({
            type:"POST",
            url:"{:U('websetting/getgoods_list')}",
            data:{keywords:keywords,domainid:domainid},
            success:function(res){
                if(res.status){
                    $.each(res.info,function(index,item){
                        var dd = $(".goods-sortable4").find("dd[gc_id="+item.id+"]").html();
                        var dd1 = $(".goods-sortable3").find("dd[gc_id="+item.id+"]").html();
                        if(typeof(dd1) == 'undefined'){ // typeof(dd) == 'undefined' || 
                            var temp_dd = "<dd gc_id='"+item.id+"' title='"+item.title+"' ondblclick='move_goods_item2("+item.id+")'>"+
                                            "<input name='temp_hot_goods[goods_list]["+item.id+"][id]' value='"+item.id+"' type='hidden' />"+
                                            "<input name='temp_hot_goods[goods_list]["+item.id+"][title]' value='"+item.title+"' type='hidden' />"+
                                            "<input name='temp_hot_goods[goods_list]["+item.id+"][price]' value='"+item.price+"' type='hidden' />"+
                                            "<input name='temp_hot_goods[goods_list]["+item.id+"][cover_id]' value='"+item.cover_id+"' type='hidden' />"+
                                            "<input name='temp_hot_goods[goods_list]["+item.id+"][marketprice]' value='"+item.marketprice+"' type='hidden' />"+
                                            "<i onclick='del_goods_item2("+item.id+")'></i>"+item.title+"</dd>";
                            $(".goods-sortable3").append(temp_dd);
                        }
                    });
                }else{
                    layer.msg("没有数据");
                }
            }
        })
    });
    // 搜索商品
    $("#searchgoods").click(function(){
        var keywords = $("#goodskeywords").val();
        if(keywords.length<0){
            layer.msg('请输入关键词！');
            return false;
        }
        
        $.ajax({
            type:"POST",
            url:"{:U('websetting/getgoods_list')}",
            data:{keywords:keywords,domainid:domainid},
            success:function(res){
                if(res.status){
                    $.each(res.info,function(index,item){
                        var dd = $(".goods-sortable2").find("dd[gc_id="+item.id+"]").html();
                        var dd1 = $(".goods-sortable1").find("dd[gc_id="+item.id+"]").html();
                        if(typeof(dd1) == 'undefined'){ // typeof(dd) == 'undefined' || 
                            var temp_dd = "<dd gc_id='"+item.id+"' title='"+item.title+"' ondblclick='move_goods_item("+item.id+")'>"+
                                            "<input name='temp_mid_goods[goods_list]["+item.id+"][id]' value='"+item.id+"' type='hidden' />"+
                                            "<input name='temp_mid_goods[goods_list]["+item.id+"][title]' value='"+item.title+"' type='hidden' />"+
                                            "<input name='temp_mid_goods[goods_list]["+item.id+"][price]' value='"+item.price+"' type='hidden' />"+
                                            "<input name='temp_mid_goods[goods_list]["+item.id+"][cover_id]' value='"+item.cover_id+"' type='hidden' />"+
                                            "<input name='temp_mid_goods[goods_list]["+item.id+"][marketprice]' value='"+item.marketprice+"' type='hidden' />"+
                                            "<i onclick='del_goods_item("+item.id+")'></i>"+item.title+"</dd>";
                            $(".goods-sortable1").append(temp_dd);
                        }
                    });
                }else{
                    layer.msg("没有数据");
                }
            }
        })
    });
    
    //筛选分类
    $("select[name=category_list]").change(function(){
        var cate_id = $(this).val();
        $.ajax({
            type: 'POST',
            url: "{:U('websetting/getCategory_list')}",// "{:('websetting/getCategory_list')}",
            data:{domainid:domainid,pid:cate_id},
            success: function(res){
                if (res.status){
                    $.each(res.info,function(index,item){
                        var dd = $(".cate-sortable").find("dd[gc_id="+item.id+"]").html();
                        if(typeof(dd) == 'undefined'){
                            var temp_dd = "<dd gc_id='"+item.id+"' title='"+item.title+"' ondblclick='del_goods_class("+item.id+")'>"+
                                            "<input name='cate_list[goods_class]["+item.id+"][id]' value='"+item.id+"' type='hidden' />"+
                                            "<input name='cate_list[goods_class]["+item.id+"][gc_name]' value='"+item.title+"' type='hidden' />"+
                                            "<i onclick='del_goods_class("+item.id+")'></i>"+item.title+"</dd>";
                            $(".cate-sortable").append(temp_dd);
                        }
                    });
                } else{
                    layer.msg('没有数据');
                }
            }
        });
    });
    </script>
</block>